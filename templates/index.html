<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8">
    <title>StepSort - Home</title>
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='images/icon.png') }}">

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

    <style>
        body {
            background: #0d0d0d;
            color: #f0f0f0;
            padding: 25px;
        }

        .container-box {
            max-width: 800px;
            margin: auto;
            background: rgba(255,255,255,0.06);
            padding: 30px;
            border-radius: 18px;
            box-shadow: 0 0 18px rgba(0,0,0,0.5);
        }

        .btn-custom {
            background: #28cee3;
            color: black;
            font-weight: bold;
            border-radius: 10px;
            border: none;
        }
        .btn-custom:hover {
            background: #1bb1c6;
        }

        .btn-yellow {
            background: #f8dc4c;
            color: black;
            font-weight: bold;
            border-radius: 10px;
            border: none;
        }
        .btn-yellow:hover {
            background: #e6c839;
        }

        a, a:hover, a:focus {
            color: #28cee3;
            text-decoration: none;
        }

        .numbers-box {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 10px;
        }
    </style>

</head>

<body>

<div class="container-box">

    <h1 class="mb-4 text-center">
        StepSort
    </h1>

    {% if error %}
    <div class="alert alert-danger text-center">
        <i class="bi bi-exclamation-triangle-fill"></i> {{ error }}
    </div>
    {% endif %}

    <form method="post">

        <!-- Nome -->
        <label class="form-label">
            <i class="bi bi-person-fill"></i> Nome do Jogador:
        </label>
        <input type="text" class="form-control mb-3" name="player" id="player" placeholder="Seu nome" required>

        <!-- Adicionar número -->
        <h5 class="mt-4"><i class="bi bi-plus-circle-fill text-info"></i> Adicionar números</h5>

        <div class="input-group mb-3">
            <input type="number" id="numberInput" class="form-control" placeholder="Digite um número">
            <button type="button" class="btn btn-custom" onclick="addNumber()">
                <i class="bi bi-plus-circle"></i> Adicionarㅤ
            </button>
        </div>

        <!-- Gerar aleatórios -->
        <div class="input-group mb-4">
            <input type="number" id="randomAmount" class="form-control" placeholder="Quantidade">
            <button type="button" class="btn btn-yellow" onclick="generateRandom()">
                <i class="bi bi-stars"></i> Randomizar
            </button>
        </div>

        <!-- Lista -->
        <h5><i class="bi bi-list-ol"></i> Lista atual:</h5>
        <p id="numbersList" class="numbers-box">[]</p>

        <input type="hidden" name="numbers" id="hiddenNumbers">

        <!-- Algoritmos -->
        <h5 class="mt-4"><i class="bi bi-cpu-fill"></i> Escolha o algoritmo:</h5>

        <div class="form-check">
            <input class="form-check-input" type="radio" id="bubbleSort" name="sorting" value="bubbleSort">
            <label class="form-check-label" for="bubbleSort">
                <i class="bi bi-bubble-chart text-info"></i> Bubble Sort
            </label>
        </div>

        <div class="form-check mb-4">
            <input class="form-check-input" type="radio" id="selectionSort" name="sorting" value="selectionSort">
            <label class="form-check-label" for="selectionSort">
                Selection Sort
            </label>
        </div>

        <!-- Botão principal -->
        <div class="d-grid">
            <button type="submit" class="btn btn-custom btn-lg" onclick="sendList()">
                <i class="bi bi-check-circle-fill"></i> Ordenar e Salvar
            </button>
        </div>

    </form>

    <!-- Link para histórico -->
    <div class="text-center mt-4">
        <a href="{{ url_for('history') }}" class="btn btn-outline-light">
            <i class="bi bi-clock-history"></i> Ver Histórico
        </a>
    </div>

</div>

<script>
    let numbers = [];

    function addNumber() {
        const input = document.getElementById("numberInput");

        if (input.value !== "") {
            // validação 4 dígitos
            if (input.value.length > 4) {
                alert("Cada número deve ter no máximo 4 dígitos (até 9999).");
                input.value = "";
                return;
            }

            // limite máximo de 20 elementos
            if (numbers.length >= 20) {
                alert("Limite máximo de 20 números atingido.");
                return;
            }

            numbers.push(Number(input.value));
            updateList();
            input.value = "";
            input.focus();
        }
    }

    function generateRandom() {
        const amount = parseInt(document.getElementById("randomAmount").value);

        if (isNaN(amount) || amount <= 0) return;

        // valida limite de 20
        if (numbers.length + amount > 20) {
            alert("Você pode ter no máximo 20 números na lista.");
            return;
        }

        // gerar valores até 9999
        for (let i = 0; i < amount; i++) {
            numbers.push(Math.floor(Math.random() * 10000));
        }

        updateList();
        document.getElementById("randomAmount").value = "";
    }

    function updateList() {
        document.getElementById("numbersList").textContent = `[${numbers.join(", ")}]`;
    }

    function sendList() {

        // validação de segurança: nada acima de 4 dígitos
        for (let n of numbers) {
            if (String(n).length > 4) {
                alert("Todos os números devem ter no máximo 4 dígitos.");
                return false;
            }
        }

        document.getElementById("hiddenNumbers").value = numbers.join(",");
        return true;
    }
</script>

</body>
</html>
